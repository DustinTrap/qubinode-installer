---
# ocp4-kvm-deployer roler vars
local_user_account: "{{ admin_user }}"
internal_domain_name: "{{ domain }}"
external_domain_name: "{{ domain }}"
installation_working_dir: "{{ project_dir }}"
idm_server_shortname: "{{ idm_hostname }}"
idm_server_ipaddr: "{{ idm_server_ip }}"
idm_server_fqdn: "{{ ipa_host }}"
user_idm_admin: "{{ idm_admin_user }}"
user_idm_password: "{{ idm_admin_pwd }}"

ocp4_version: 4.3.3
#ocp4_image_version: 4.3.0
ocp4_dependencies_version: "{{ ocp4_version[:3] }}"
ocp4_image_version: "{{ ocp4_version[:3] + '.0' }}"
pull_secret: "{{ installation_working_dir }}/pull-secret.txt"

# ocp4 nodes attributes
master_count: 3
compute_count: 3
master_ip_octet: 10
compute_ip_octet: 20
bootstrap_node_name: bootstrap

# Networking info
ocp4_nat_subnet: 192.168.50.0
ocp4_nat_gateway: "{{ ocp4_nat_subnet.split('.')[:3] | join('.')}}.1"
listen_address: "{{ kvm_host_ip }}"
bootstrap_ip: "{{ ocp4_nat_subnet.split('.')[:3] | join('.')}}.2"
ocp4_lb_container: qbn-lb
lb_name: "{{ ocp4_lb_container }}"
old_libvirt_net: qbn # this was ocp4 need to see what to do with this 
deploy_ocp4_configs: yes
#deploy_ocp4_configs: True
mask: 255.255.255.0
mac_start: "52:54:00:"
cluster_name: qbn
dns_domain: "{{ domain }}"
dns_server_ip: "{{ idm_server_ip }}"
bootstrap_webserver_ip: "{{ kvm_host_ip }}"
rhcos_metal_bios: "http://{{ bootstrap_webserver_ip }}:8080/pub/{{ ocp4_dependencies_version }}/images/{{ coreos_metal_bios }}"
rhcos_ignition_url: "http://{{ bootstrap_webserver_ip }}:8080/pub/{{ ocp4_dependencies_version }}/ignitions"
rhcos_ignition: "{{ rhcos_ignition_url}}/{{ vm_type }}.ign"
#coreos_metal_bios: "rhcos-{{ ocp4_image_version }}-x86_64-metal-bios.raw.gz"
coreos_metal_bios: "rhcos-{{ ocp4_image_version }}-x86_64-metal.raw.gz"
libvirt_network_mode: nat
libivrt_network_domain: compute.local

#vm_public_key: "{{ vm_public_key }}"
local_user_ssh_public_key: "/home/{{ local_user_account }}/.ssh/id_rsa.pub"
ssh_ocp4_public_key: "{{ lookup('file', local_user_ssh_public_key) }}"


openshift_install_folder: ocp4
openshift_install_dir: "{{ installation_working_dir }}/{{ openshift_install_folder }}"
ignition_files_dir: "{{ openshift_install_dir }}"
podman_webserver: qbn-httpd
rhcos_webserver_img_name: rhcos-webserver
dest_ignitions_web_directory: "{{ webserver_directory }}/{{ ocp4_dependencies_version }}/ignitions/"
webserver_dependencies: "{{ webserver_directory }}/{{ ocp4_dependencies_version }}"
webserver_images: "{{ webserver_directory }}/{{ ocp4_dependencies_version }}/images"
coreos_installer_kernel: "rhcos-{{ ocp4_image_version }}-x86_64-installer-kernel"
coreos_installer_initramfs: "rhcos-{{ ocp4_image_version }}-x86_64-installer-initramfs.img"
coreos_tmp_dir: /tmp/build_coreos_container
openshift_mirror: http://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos/{{ ocp4_dependencies_version }}/{{ ocp4_image_version }}
tear_down: false
virtinstall_dir: "{{ installation_working_dir }}/rhcos-install/"
webserver_directory: /opt/qubinode_webserver
ocp4_cluster_domain: "cloud.{{ domain }}"
dns_teardown: false
idm_dns_forward_zone: "{{ ocp4_cluster_domain }}"
idm_dns_reverse_zone: "50.168.192.in-addr.arpa."
dns_wildcard: "*.apps.{{ cluster_name }}"
nat_gateway: "192.168.50.1"
product: "{{ openshift_product }}"
openshift_pool_id: ""
openshift_product: ""

ocp4_instances:
  - name: master
    hd_size: 120G
    memory_size: 16192
    cpu_size: 4
    extra_storage:
      - size: 10G
        enable: true
        name: vdb
      - size: 50G
        enable: true
        name: vdc
    qty: "{{ master_count }}"
    vm_type: master
    ip_octet: "{{ master_ip_octet }}"
  - name: compute
    hd_size: 120G
    memory_size: 16192
    cpu_size: 4
    extra_storage:
      - size: 10G
        name: vdb
        enable: true
      - size: 100G
        name: vdc
        enable: true
    qty: "{{ compute_count }}"
    vm_type: worker
    ip_octet: "{{ compute_ip_octet }}"
  - name: bootstrap
    hd_size: 120G
    memory_size: 16192
    cpu_size: 2
    extra_storage:
      - size: ""
        name: vdb
        enable: false
      - size: ""
        name: vdc
        enable: false
    qty: 1
    vm_type: bootstrap
    ip_octet: 30

## Local storage variable 
localstorage_version: '4.3'
localstorage_filesystem: false
localstorage_block: false

## Defaults for NFS Provisioner role
provision_nfs_server: true
nfs_server_directory_path: /export
provision_nfs_provisoner: true
configure_registry: true
nfs_server_ip:  "{{ kvm_host_ip }}"
registry_pvc_size: 100Gi
storage_class_result: true
openshift_token: 1234567890
openshift_url: "https://master-0.{{ cluster_name }}.{{ ocp4_cluster_domain }}:6443"
openshift_version: ocp4
project_namespace: nfs-provisioner
set_as_default: true
delete_deployment: false
insecure_skip_tls_verify: true
